# SQL AI Copilot - 中文编码问题解决方案

## 问题描述
在其他电脑上运行程序时出现中文乱码问题，这是由于Windows系统的字符编码设置不同导致的。

## 解决方案

### 方案一：使用UTF-8版本（推荐）

我们已经为您编译了一个专门支持UTF-8编码的版本：

#### 文件位置
```
SQL_AI_Copilot_Simple/
├── sql_ai_copilot_utf8.exe     # UTF-8版本主程序
├── 启动程序_UTF8.bat           # UTF-8版本启动脚本
└── 启动程序_修复版.bat         # 修复版启动脚本
```

#### 使用方法
1. 进入 `SQL_AI_Copilot_Simple` 文件夹
2. 双击 `启动程序_UTF8.bat`
3. 程序会自动设置UTF-8编码并启动

### 方案二：手动设置编码

如果UTF-8版本仍有问题，可以手动设置：

#### 方法1：在命令行中设置
```cmd
chcp 65001
sql_ai_copilot.exe
```

#### 方法2：使用PowerShell
```powershell
powershell -Command "& .\启动程序.bat"
```

### 方案三：修改Windows系统设置

#### 步骤：
1. 打开控制面板
2. 进入"区域"设置
3. 点击"管理"选项卡
4. 点击"更改系统区域设置"
5. 勾选"使用 Unicode UTF-8 提供全球语言支持"
6. 重启计算机

### 方案四：使用修复版启动脚本

我们提供了一个修复版的启动脚本，它会自动设置编码：

```batch
@echo off
REM 设置UTF-8编码
chcp 65001 >nul 2>&1
title SQL AI Copilot - 中文版
color 0A

echo ========================================
echo    SQL AI Copilot 启动中...
echo ========================================
echo.

REM 检查配置文件
if not exist "config\ai_models.json" (
    echo [错误] 未找到配置文件 config\ai_models.json
    echo 请确保配置文件存在且格式正确
    echo.
    pause
    exit /b 1
)

REM 启动程序
echo [信息] 启动主程序...
sql_ai_copilot.exe

REM 检查程序退出状态
if %errorlevel% neq 0 (
    echo.
    echo [错误] 程序异常退出，错误代码：%errorlevel%
    echo 可能的原因：
    echo 1. 网络连接问题
    echo 2. API密钥无效
    echo 3. 配置文件格式错误
    echo.
    pause
)

echo.
echo [信息] 程序已退出
pause
```

## 技术原理

### 编码问题原因
1. **代码页不匹配**：不同Windows系统默认使用不同的代码页
2. **控制台设置**：控制台字体和编码设置影响中文显示
3. **程序编译**：程序编译时的编码设置影响运行时显示

### 解决方案原理
1. **UTF-8编码**：使用统一的UTF-8编码，支持所有中文字符
2. **控制台设置**：通过Windows API设置控制台编码和字体
3. **启动脚本**：在启动时自动设置正确的编码

## 文件说明

### 新增文件
- `main_utf8.cpp` - 支持UTF-8编码的主程序源码
- `build_utf8.bat` - UTF-8版本编译脚本
- `fix_encoding.bat` - 编码修复工具
- `启动程序_修复版.bat` - 修复版启动脚本
- `启动程序_UTF8.bat` - UTF-8版本启动脚本

### 编译选项
```bash
# UTF-8版本编译命令
g++ -std=c++11 -Iinclude -o sql_ai_copilot_utf8.exe \
    main_utf8.cpp \
    src/agent1_input/agent1_input.cpp \
    src/agent2_diagnose/agent2_diagnose.cpp \
    src/agent3_strategy/agent3_strategy.cpp \
    src/agent4_report/agent4_report.cpp \
    src/agent5_interactive/agent5_interactive.cpp \
    src/ai_engine/ai_engine_simple.cpp \
    src/utils/utils.cpp \
    -lwinhttp
```

## 测试方法

### 测试步骤
1. 复制 `SQL_AI_Copilot_Simple` 文件夹到其他电脑
2. 运行 `启动程序_UTF8.bat`
3. 检查中文显示是否正常
4. 测试程序功能是否正常

### 常见问题排查
1. **仍有乱码**：检查Windows版本，建议使用Windows 10/11
2. **程序无法启动**：检查是否安装了必要的运行时库
3. **网络问题**：检查防火墙和网络连接设置

## 部署建议

### 推荐部署方式
1. 使用UTF-8版本进行部署
2. 在目标机器上测试编码显示
3. 提供多种启动方式供用户选择

### 用户指导
1. 优先使用 `启动程序_UTF8.bat`
2. 如遇问题，尝试 `启动程序_修复版.bat`
3. 最后可手动设置编码：`chcp 65001`

## 总结

通过以上解决方案，我们提供了多种方式来解决中文编码问题：

✅ **UTF-8版本** - 专门编译的支持UTF-8的版本
✅ **修复版启动脚本** - 自动设置编码的启动脚本
✅ **手动设置方法** - 用户可手动设置编码
✅ **系统设置方案** - 修改Windows系统编码设置

这些方案确保了程序在不同Windows系统上都能正常显示中文，解决了跨平台部署时的编码问题。 